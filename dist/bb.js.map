{"version":3,"sources":["../src/bb.js"],"names":["refreshHash","hashUrl","params","id","BASE_ENDPOINT","headers","DEFAULT_HEADERS","method","body","querystring","stringify","response","text","hash","BB","LoginCookie","setGlobal","getGlobal","branch","account","password","loginUrl","idh","dependenciaOrigem","numeroContratoOrigem","senhaConta","titularidade","apelido","idDispositivo","get","JSON","parse","login","checking","BBChecking"],"mappings":";;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AAEA,IAAMA,WAAW,GAAG,SAAdA,WAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AACZC,UAAAA,OADY,GACF,MADE;AAEZC,UAAAA,MAFY,GAEH;AAAEC,YAAAA,EAAE,EAAE;AAAN,WAFG;AAAA;AAAA,+CAIK,qCAASC,wBAAT,SAAyBH,OAAzB,GAAoC;AACzDI,YAAAA,OAAO,EAAEC,0BADgD;AAEzDC,YAAAA,MAAM,EAAE,MAFiD;AAGzDC,YAAAA,IAAI,EAAEC,wBAAYC,SAAZ,CAAsBR,MAAtB;AAHmD,WAApC,CAJL;;AAAA;AAIZS,UAAAA,QAJY;AAAA;AAAA,+CAUCA,QAAQ,CAACC,IAAT,EAVD;;AAAA;AAUZC,UAAAA,IAVY;AAAA,2CAYXA,IAZW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAApB;;IAeqBC,E;;;AAOnB,gBAAc;AAAA;AAAA,uDANH,IAMG;AAAA,sDAJJ,IAII;AAAA,yDAFD,IAEC;;AACZC,4BAAYC,SAAZ;AACD;;;;iCAEY;AACX,aAAO,CAAC,CAACD,wBAAYE,SAAZ,EAAT;AACD;;;;;;;;;;AAEaC,cAAAA,M,QAAAA,M,EAAQC,O,QAAAA,O,EAASC,Q,QAAAA,Q;AACvBC,cAAAA,Q,GAAW,4B;;mDACErB,WAAW,E;;;AAAxBa,cAAAA,I;AAEAX,cAAAA,M,GAAS;AACboB,gBAAAA,GAAG,EAAET,IADQ;AAEbU,gBAAAA,iBAAiB,EAAEL,MAFN;AAGbM,gBAAAA,oBAAoB,EAAEL,OAHT;AAIbM,gBAAAA,UAAU,EAAEL,QAJC;AAKbM,gBAAAA,YAAY,EAAE,GALD;AAMbC,gBAAAA,OAAO,EAAE,mBANI;AAObC,gBAAAA,aAAa,EAAE;AAPF,e;;mDAUQ,qCAASxB,wBAAT,SAAyBiB,QAAzB,GAAqC;AAC1DhB,gBAAAA,OAAO,EAAEC,0BADiD;AAE1DC,gBAAAA,MAAM,EAAE,MAFkD;AAG1DC,gBAAAA,IAAI,EAAEC,wBAAYC,SAAZ,CAAsBR,MAAtB;AAHoD,eAArC,C;;;AAAjBS,cAAAA,Q;;AAMNI,sCAAYC,SAAZ,CAAsBL,QAAQ,CAACN,OAAT,CAAiBwB,GAAjB,CAAqB,YAArB,CAAtB;;;mDAEmBlB,QAAQ,CAACC,IAAT,E;;;AAAbA,cAAAA,I;4BACYkB,IAAI,CAACC,KAAL,CAAWnB,IAAX,C,EAAVoB,K,eAAAA,K;AAER,mBAAKC,QAAL,GAAgB,IAAIC,oBAAJ,EAAhB;gDAEOF,K","sourcesContent":["import fetch from 'node-fetch';\r\nimport querystring from 'querystring';\r\nimport LoginCookie from './loginCookie';\r\nimport { BASE_ENDPOINT, DEFAULT_HEADERS } from './constants';\r\nimport BBChecking from './checking';\r\n\r\nconst refreshHash = async () => {\r\n  const hashUrl = 'hash';\r\n  const params = { id: '00000000000000000000000000000000' };\r\n\r\n  const response = await fetch(`${BASE_ENDPOINT}${hashUrl}`, {\r\n    headers: DEFAULT_HEADERS,\r\n    method: 'POST',\r\n    body: querystring.stringify(params),\r\n  });\r\n\r\n  const hash = await response.text();\r\n\r\n  return hash;\r\n};\r\n\r\nexport default class BB {\r\n  checking = null;\r\n\r\n  savings = null;\r\n\r\n  creditCard = null;\r\n\r\n  constructor() {\r\n    LoginCookie.setGlobal();\r\n  }\r\n\r\n  isLoggedIn() {\r\n    return !!LoginCookie.getGlobal();\r\n  }\r\n\r\n  async login({ branch, account, password }) {\r\n    const loginUrl = 'servico/ServicoLogin/login';\r\n    const hash = await refreshHash();\r\n\r\n    const params = {\r\n      idh: hash,\r\n      dependenciaOrigem: branch,\r\n      numeroContratoOrigem: account,\r\n      senhaConta: password,\r\n      titularidade: '1',\r\n      apelido: 'NickRandom.123456',\r\n      idDispositivo: '2131296671',\r\n    };\r\n\r\n    const response = await fetch(`${BASE_ENDPOINT}${loginUrl}`, {\r\n      headers: DEFAULT_HEADERS,\r\n      method: 'POST',\r\n      body: querystring.stringify(params),\r\n    });\r\n\r\n    LoginCookie.setGlobal(response.headers.get('set-cookie'));\r\n\r\n    const text = await response.text();\r\n    const { login } = JSON.parse(text);\r\n\r\n    this.checking = new BBChecking();\r\n\r\n    return login;\r\n  }\r\n}\r\n"],"file":"bb.js"}